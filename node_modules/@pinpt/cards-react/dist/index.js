"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t,n,r,o=require("react"),i=e(o),a=e(require("@pinpt/uic.next/Loader"));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))}function l(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(t=exports.PROFILE_FRAME_COMMANDS||(exports.PROFILE_FRAME_COMMANDS={})).SET_SIZE="profile:setSize",t.LOADING_DONE="profile:loadingDone",t.EDIT="profile:edit",(n=exports.PROFILE_EDITABLE_FIELDS||(exports.PROFILE_EDITABLE_FIELDS={})).EXPERIENCE="experience",n.ACCOMPLISHMENTS="accomplishments",n.SOCIALS="socials",n.AVATAR="override_avatar_url",n.LOCATION="location",n.DESCRIPTION="description",n.VISIBLE="visible",n.LANGUAGES="top_languages",n.DOMAINS="domain_data",n.DEPARTMENTS="department_data",n.FAVORITES="favorites",(r=exports.PROFILE_EDIT_ACTIONS||(exports.PROFILE_EDIT_ACTIONS={})).CREATE="create",r.EDIT="edit",r.DELETE="delete";var c,p,E="styles_ProfileWrapper__10y9k",d="styles_Frame__2JKRP",f="styles_Loader__3TOLC",_="styles_Loading__2n-zY";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".styles_ProfileWrapper__10y9k {\n  position: relative;\n  display: flex;\n  min-height: 60px;\n}\n.styles_ProfileWrapper__10y9k .styles_Frame__2JKRP {\n  flex-grow: 1;\n}\n.styles_ProfileWrapper__10y9k .styles_Loader__3TOLC {\n  display: none;\n}\n.styles_ProfileWrapper__10y9k .styles_Loader__3TOLC.styles_Loading__2n-zY {\n  z-index: 1;\n  background: white;\n  display: block;\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: 0;\n  bottom: 0;\n}\n"),(c=exports.FRAME_EVENT_ORIGINS||(exports.FRAME_EVENT_ORIGINS={})).PROFILE="pinpointProfileCard",c.WEBAPP_SETTINGS="pinpointWebappSettings",c.MOCK_PROFILE="pinpointProfileCardMock",c.WEBAPP_SETTINGS_SIGNUP="pinpointWebappSettingsSignup",c.RETRO="pinpointRetroCard",c.MOCK_RETRO="pinpointRetroCardMock",c.WEBAPP_RETRO="pinpointWebappRetro",(p=exports.ENVIRONMENTS||(exports.ENVIRONMENTS={})).EDGE="edge",p.LOCAL="local",p.STABLE="stable";var v,m=function(e,t,n,r,o,i){var a="&source=pinpoint-embed&editable="+(n?"true":"false")+"&fullScreen="+(r?"true":"false")+"&chrome="+(o?"false":"true")+"&frameless="+(i?"true":"false");switch(e){case exports.ENVIRONMENTS.LOCAL:return"https://cards.local.ppoint.io:3002/profile/"+t+"?env=local"+a;case exports.ENVIRONMENTS.EDGE:return"https://cards.pinpoint.com/profile/"+t+"?env=edge"+a;case exports.ENVIRONMENTS.STABLE:default:return"https://cards.pinpoint.com/profile/"+t+"?env=stable"+a}};(v=exports.RETRO_FRAME_COMMANDS||(exports.RETRO_FRAME_COMMANDS={})).SET_SIZE="retro:setSize",v.LOADING_DONE="retro:loadingDone";exports.MockProfile=function(e){var t,n,r,c,p=e.onReady,v=u(o.useState(!0),2),m=v[0],N=v[1],S=u(o.useState(0),2),I=S[0],R=S[1],O=o.useRef(null),M=o.useMemo((function(){var e=[d];return m&&e.push(_),e.join(" ")}),[m]),T=o.useMemo((function(){var e=[f];return m&&e.push(_),e.join(" ")}),[m]),h=o.useMemo((function(){var t=[E];return e.className&&t.push(e.className),t.join(" ")}),[e.className]),y=o.useCallback((function(e){return s(void 0,void 0,void 0,(function(){var t,n,r;return l(this,(function(o){if((t=e.data)&&t.origin===exports.FRAME_EVENT_ORIGINS.MOCK_PROFILE)switch((n=t).command){case exports.PROFILE_FRAME_COMMANDS.SET_SIZE:return r=n.value,R(r),[2,!0];case exports.PROFILE_FRAME_COMMANDS.LOADING_DONE:return N(!1),p&&p(n.visible),[2,!0];default:return[2,!1]}return[2,!1]}))}))}),[R,N,p]),A=o.useMemo((function(){return{height:I+2+"px"}}),[I]);return o.useEffect((function(){return window.addEventListener("message",y),function(){window.removeEventListener("message",y)}}),[y]),i.createElement("div",{className:h},i.createElement("iframe",{src:(n=e.avatar,r=e.firstName,c=e.lastName,"https://cards.pinpoint.com/profile/mock?avatar="+encodeURIComponent(n)+"&first_name="+encodeURIComponent(r)+"&last_name="+encodeURIComponent(c)),title:null!==(t=e.frameTitle)&&void 0!==t?t:"Developer Profile",className:M,style:A,scrolling:"yes",ref:O}),i.createElement("div",{className:T},i.createElement(a,{screen:!0})))},exports.Profile=function(e){var t,n,r,c,p,v,N=e.handleFieldUpdate,S=e.onReady,I=u(o.useState(!0),2),R=I[0],O=I[1],M=u(o.useState(0),2),T=M[0],h=M[1],y=o.useRef(null),A=o.useMemo((function(){var e=[d];return R&&e.push(_),e.join(" ")}),[R]),L=o.useMemo((function(){var e=[f];return R&&e.push(_),e.join(" ")}),[R]),x=o.useMemo((function(){var t=[E];return e.className&&t.push(e.className),t.join(" ")}),[e.className]),P=o.useCallback((function(e,t){var n,r;return(null===(r=null===(n=y.current)||void 0===n?void 0:n.contentWindow)||void 0===r?void 0:r.postMessage)&&y.current.contentWindow.postMessage({success:!1,field:e,rollbackValue:t,origin:exports.FRAME_EVENT_ORIGINS.WEBAPP_SETTINGS},"*"),!1}),[]),C=o.useCallback((function(e){var t,n;return(null===(n=null===(t=y.current)||void 0===t?void 0:t.contentWindow)||void 0===n?void 0:n.postMessage)&&y.current.contentWindow.postMessage({success:!0,field:e,origin:exports.FRAME_EVENT_ORIGINS.WEBAPP_SETTINGS},"*"),!1}),[]),b=o.useCallback((function(e){return s(void 0,void 0,void 0,(function(){var t,n,r,o;return l(this,(function(i){switch(i.label){case 0:if(t=e.field,n=e.developer_profile_id,r=e.newValue,o=e.originalValue,!N)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,N(n,t,r)];case 2:return i.sent()?(C(t),[2,!0]):[2,P(t,o)];case 3:return i.sent(),[2,P(t,o)];case 4:return[2,!1]}}))}))}),[N,P,C]),g=o.useCallback((function(t){return s(void 0,void 0,void 0,(function(){var n,r,o;return l(this,(function(i){if((n=t.data)&&n.origin===exports.FRAME_EVENT_ORIGINS.PROFILE){if((r=n).id===e.profile_id)switch(r.command){case exports.PROFILE_FRAME_COMMANDS.SET_SIZE:return o=r.value,h(o),[2,!0];case exports.PROFILE_FRAME_COMMANDS.LOADING_DONE:return O(!1),S&&S(r.visible),[2,!0];case exports.PROFILE_FRAME_COMMANDS.EDIT:return[2,b(r)];default:return[2,!1]}return[2,!1]}return[2,!1]}))}))}),[h,O,b,S,e.profile_id]),D=o.useMemo((function(){return{height:T+2+"px"}}),[T]);return o.useEffect((function(){return window.addEventListener("message",g),function(){window.removeEventListener("message",g)}}),[g]),i.createElement("div",{className:x},i.createElement("iframe",{src:m(null!==(t=e.environment)&&void 0!==t?t:exports.ENVIRONMENTS.STABLE,e.profile_id,null!==(n=e.enableEditing)&&void 0!==n&&n,null!==(r=e.fullScreen)&&void 0!==r&&r,null!==(c=e.disableChrome)&&void 0!==c&&c,null!==(p=e.frameless)&&void 0!==p&&p),title:null!==(v=e.frameTitle)&&void 0!==v?v:"Developer Profile",className:A,style:D,scrolling:"yes",ref:y}),i.createElement("div",{className:L},i.createElement(a,{screen:!0})))};
//# sourceMappingURL=index.js.map
